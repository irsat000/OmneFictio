@using OmneFictio.Web.Models
@using OmneFictio.Web.PostReadModel
@using PostModel = OmneFictio.Web.PostReadModel
@model GetpostViewmodel

@{
    ViewData["Title"] = "Post";
    @section Stylesheets {
        <link rel="stylesheet" href="~/css/post.css" asp-append-version="true" />
    }
    @section Scripts {
        <script src="~/js/post.js" asp-append-version="true" ></script>
    }
}
@{
    PostModel.PostRead1 post = @Model.post!;

    string userId = "-1";
    string username = "";
    string userPicture = "none"; 

    userId = User.Claims.FirstOrDefault(claim => claim.Type == "nameid")?.Value ?? "-1";
    username = User.Claims.FirstOrDefault(claim => claim.Type == "unique_name")?.Value ?? "";
    userPicture = User.Claims.FirstOrDefault(claim => claim.Type == "actort")?.Value ?? "none";
}
<input type="hidden" value="@post.id" id="postid">



<template id="comment_instance">
    <div class="comment-cont">
        <div class="comment">
            <div class="c-header">
                <img src="/images/users/user_no_photo_300x300.png">
                <span class="c-username">
                    
                </span>
                <span class="c-date">
                
                </span>
                <div class="c-menu">
                    <i class="bi bi-three-dots"></i>
                </div>
                <ul class="c-menupopup">
                    <li>Report</li>
                    <li>Block User</li>
                </ul>
            </div>
            <div class="c-text">
                <span class="c-body">
                    
                </span>
            </div>
            <div class="c-footer">
                <div class="c-evaluation">
                    <i class="bi bi-hand-thumbs-up c-likebtn likebtn"></i>
                    <span class="c-likes">

                    </span>
                    <i class="bi bi-hand-thumbs-down c-dislikebtn dislikebtn"></i>
                    <a href="#" class="c-replybtn">Reply</a>
                </div>
                <div class="get_replies">
                    <span class="get_replies-text">
                        
                    </span>
                </div>
            </div>
        </div>
        <div class="reply">
            <div class="r-text">
                <span>Elle girilmiş yanıt.</span>
            </div>
            <div class="r-footer">
                <div class="r-evaluation">
                    <i class="bi bi-hand-thumbs-up r-likebtn likebtn"></i>
                    <span class="r-likes">5465</span>
                    <i class="bi bi-hand-thumbs-down r-dislikebtn dislikebtn"></i>
                    <span class="r-gotoreply">GO</span>
                </div>
                <div class="r-user">
                    <span class="r-username">MrBombastic</span>
                    <img src="/images/users/user_no_photo_300x300.png">
                </div>
            </div>
        </div>
    </div>
</template>




<div class="modal-chapters" id="modal-chapters">
    <div class="mc-header">
        <span>Chapters</span>
        <div class="mc-close" id="mc-close">
            <i class="bi bi-x-lg"></i>
        </div>
    </div>
    <div class="mc-body">
        <ul>
            @foreach (Chapter chapter in 
                post.chapters.OrderBy(s => s.chapterIndex).ToList())
            {
                <li><a href="#">@chapter.title</a></li>
            }
        </ul>
    </div>
</div>

<div class="modal-replies" id="modal-replies">
    <div class="mr-header">
        <span>Replies</span>
        <div class="mr-close" id="mr-close">
            <i class="bi bi-x-lg"></i>
        </div>
    </div>
    <div class="mr-body">
        <div class="mr-comment">
            <div class="mrc-header">
                <img src="/images/users/user_no_photo_300x300.png" onerror="this.onerror=null; this.src='/images/onerror/user_no_photo_300x300.png'">
                <span class="mrc-username">MrBombastic</span>
                <span class="mrc-date">26/09/2022</span>
                <div class="mrc-menu">
                    <i class="bi bi-three-dots"></i>
                </div>
            </div>
            <div class="mrc-text">
                <span>This is a comment right here. This is a comment right here. This is a comment right here. This is a comment right here.</span>
            </div>
            <div class="mrc-footer">
                <div class="mrc-evaluation">
                    <i class="bi bi-hand-thumbs-up mrc-likebtn likebtn"></i>
                    <span class="mrc-likes">5465</span>
                    <i class="bi bi-hand-thumbs-down mrc-dislikebtn dislikebtn"></i>
                    <a href="#" class="mrc-replybtn">Reply</a>
                </div>
            </div>
        </div>

        <div class="mr-reply">
            <div class="mrr-header">
                <img src="/images/users/user_no_photo_300x300.png" onerror="this.onerror=null; this.src='/images/onerror/user_no_photo_300x300.png'">
                <span class="mrr-username">MrBombastic</span>
                <span class="mrr-date">26/09/2022</span>
            </div>
            <div class="mrr-text">
                <span>This is a reply right here. This is a reply right here. This is a reply right here.</span>
            </div>
            <div class="mrr-footer">
                <div class="mrr-evaluation">
                    <i class="bi bi-hand-thumbs-up mrr-likebtn likebtn"></i>
                    <span class="mrr-likes">5465</span>
                    <i class="bi bi-hand-thumbs-down mrr-dislikebtn dislikebtn"></i>
                    <a href="#" class="mrr-replybtn">Reply</a>
                </div>
                <div class="mrr-menu">
                    <i class="bi bi-three-dots"></i>
                </div>
            </div>
        </div>

        
        <div class="mr-reply">
            <div class="mrr-header">
                <img src="/images/users/user_no_photo_300x300.png" onerror="this.onerror=null; this.src='/images/onerror/user_no_photo_300x300.png'">
                <span class="mrr-username">MrBombastic</span>
                <span class="mrr-date">26/09/2022</span>
            </div>
            <div class="mrr-text">
                <span>This is a reply right here. This is a reply right here. This is a reply right here.</span>
            </div>
            <div class="mrr-footer">
                <div class="mrr-evaluation">
                    <i class="bi bi-hand-thumbs-up mrr-likebtn likebtn"></i>
                    <span class="mrr-likes">5465</span>
                    <i class="bi bi-hand-thumbs-down mrr-dislikebtn dislikebtn"></i>
                    <a href="#" class="mrr-replybtn">Reply</a>
                </div>
                <div class="mrr-menu">
                    <i class="bi bi-three-dots"></i>
                </div>
            </div>
        </div>


        <div class="mr-reply">
            <div class="mrr-header">
                <img src="/images/users/user_no_photo_300x300.png" onerror="this.onerror=null; this.src='/images/onerror/user_no_photo_300x300.png'">
                <span class="mrr-username">MrBombastic</span>
                <span class="mrr-date">26/09/2022</span>
            </div>
            <div class="mrr-text">
                <span>This is a reply right here. This is a reply right here. This is a reply right here.</span>
            </div>
            <div class="mrr-footer">
                <div class="mrr-evaluation">
                    <i class="bi bi-hand-thumbs-up mrr-likebtn likebtn"></i>
                    <span class="mrr-likes">5465</span>
                    <i class="bi bi-hand-thumbs-down mrr-dislikebtn dislikebtn"></i>
                    <a href="#" class="mrr-replybtn">Reply</a>
                </div>
                <div class="mrr-menu">
                    <i class="bi bi-three-dots"></i>
                </div>
            </div>
        </div>

    </div>
</div>

<div class="post-2">
    <div class="post-card">
        <div class="p-body">
            @if(post.coverImage != null){
                <div class="p-cover">
                    <img src="/images/covers/@post.coverImage" class="p-basecover" 
                        onerror="this.onerror=null; this.closest('.p-cover').remove()">
                    <img src="/images/covers/@post.coverImage" class="p-megacover">
                </div>
            }
            <div class="p-text">
                <div class="p-title-cont">
                    <span class="p-title">@post!.title</span>
                    <span class="p-date">@post.publishDate.Date.ToShortDateString()</span>
                </div>
                <span class="p-description">@post.postDescription</span>
            </div>
        </div>
        <div class="p-footer">
            <div class="p-footer-wrap">
                <div class="p-evaluation">
                    <i class="bi bi-hand-thumbs-up post-vote p-likebtn likebtn" data-action="like"></i>
                    <span class="p-likes">
                        @{
                            if(post.voteResult >= 0)
                                @post.voteResult
                            else
                                @Html.Raw("--")
                        }
                    </span>
                    <i class="bi bi-hand-thumbs-down post-vote p-dislikebtn dislikebtn" data-action="dislike"></i>
                    <span class="p-rate">
                        @{
                            if(post.rateResult >= 0 && post.rateResult <= 10)
                                @Html.Raw(Math.Round(post.rateResult, 1).ToString() + "/10")
                            else
                                @Html.Raw("-/10")
                        }
                    </span>
                </div>
                <div class="p-user">
                    @if(post.account != null){
                        <span class="p-username">
                            @if(post.account.displayName != null)
                                @post.account.displayName
                            else
                                @post.account.username
                        </span>
                    }else{
                        <span class="p-username p-deleted_user">DeletedUser</span>
                    }
                    <div class="p-uimg-cont">
                        <img src="/images/users/@userPicture" onerror="this.onerror=null; this.src='/images/onerror/user_no_photo_300x300.png'">
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="post-more">
        <div class="p-actions">
            <button type="button" class="pd-saved">Save</button>
            <button type="button">Share</button>
            <button type="button">Report</button>
        </div>
        <div class="pd-items">
            @if(post.postType != null){
                <span>@post.postType.body</span>
            }
            @if(post.language != null){
                <span>@post.language.body</span>
            }
            @if(post.postStatus != null){
                <span>@post.postStatus.body</span>
            }
            @if(post.ratedAs != null){
                <span>@post.ratedAs.body</span>
            }
        </div>
        @if(post.existingStories.Count > 0){
            <div class="pd-series">
                @foreach(ExistingStory story in post.existingStories){
                    <span>@story.body</span>
                }
            </div>
        }
        <div class="pd-tags">
            @if(post.tags.Count < 1){
                <span>No tag</span>
            } else{
                foreach(Tag tag in post.tags){
                    <span>@tag.body</span>
                }
            }
        </div>
    </div>
    
</div>

<div class="start_reading">
    <a href="#">Start Reading</a>
</div>

<div class="chapter_selection">
    <span id="get_chapters">Chapters</span>
    <a href="#">Open all</a>
</div>

<!--<div class="rate_it">
    <button>Rate again</button>
    <span>8/10</span>
</div>-->
<div class="rate_it">
    <button>Rate it</button>
</div>

@if(userId != "-1"){ ///images/users/
    <div class="add_comment-cont">
        <textarea placeholder="This is where we comment."></textarea>
        <div class="ac-footer">
            <div class="ac-user">
                <img src="/images/users/@userPicture" onerror="this.onerror=null; this.src='/images/onerror/user_no_photo_300x300.png'">
                <span class="ac-username">@username</span>
            </div>
            <a href="#" class="comment-btn">Send</a>
        </div>
    </div>
}

<div class="comments" id="comment-section">
<!--
    foreach (PostModel.Comment comment in post.comments)
    {
    <div class="comment-cont">
        <div class="comment" id="comment-comment.id">
            <div class="c-header">
                <img src="/images/users/user_no_photo_300x300.png">
                <span class="c-username">
                    if(comment.account.displayName != null) {
                        comment.account.displayName
                    } else {
                        comment.account.username
                    }
                </span>
                <span class="c-date">comment.publishDate.Date.ToShortDateString()</span>
                <div class="c-menu">
                    <i class="bi bi-three-dots"></i>
                </div>
                <ul class="c-menupopup">
                    <li>Report</li>
                    <li>Block User</li>
                </ul>
            </div>
            <div class="c-text">
                <span>comment.body</span>
            </div>
            <div class="c-footer">
                <div class="c-evaluation">
                    <i class="bi bi-hand-thumbs-up c-likebtn likebtn"></i>
                    <span class="c-likes">
                        {
                            if(comment.voteResult >= 0)
                                comment.voteResult
                            else
                                Html.Raw("--")
                        }
                    </span>
                    <i class="bi bi-hand-thumbs-down c-dislikebtn dislikebtn"></i>
                    <a href="#" class="c-replybtn">Reply</a>
                </div>
                <div class="get_replies">
                    <span>comment.replies.Count replies</span>
                </div>
            </div>
        </div>
        <div class="reply">
            <div class="r-text">
                <span>Elle girilmiş yanıt.</span>
            </div>
            <div class="r-footer">
                <div class="r-evaluation">
                    <i class="bi bi-hand-thumbs-up r-likebtn likebtn"></i>
                    <span class="r-likes">5465</span>
                    <i class="bi bi-hand-thumbs-down r-dislikebtn dislikebtn"></i>
                    <span class="r-gotoreply">GO</span>
                </div>
                <div class="r-user">
                    <span class="r-username">MrBombastic</span>
                    <img src="/images/users/user_no_photo_300x300.png">
                </div>
            </div>
        </div>
    </div>
    }
-->
</div>
